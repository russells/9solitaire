From: Russell Steicke <russells@adelie.cx>
Subject: Write a C version of this.

Speed.

Signed-off-by: Russell Steicke <russells@adelie.cx>
